<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • DDModeling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="DDModeling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">DDModeling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/Setup.html">Setup</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Tutorials/Model_definition.html">1. Defining models</a>
    </li>
    <li>
      <a href="../../articles/Tutorials/Model_simulation.html">2. Simulating models</a>
    </li>
    <li>
      <a href="../../articles/Tutorials/Import_data.html">3. Importing data</a>
    </li>
    <li>
      <a href="../../articles/Tutorials/Generate_GRIDs.html">4. Generating GRIDs</a>
    </li>
    <li>
      <a href="../../articles/Tutorials/Applying_DL.html">5. Applying DL</a>
    </li>
    <li>
      <a href="../../articles/Tutorials/Fitting_models.html">6. Fitting models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Pelzer402/DDModeling/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Applying_DL_files/header-attrs-2.3/header-attrs.js"></script><script src="Applying_DL_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Pelzer402/DDModeling/blob/master/vignettes/Tutorials/Applying_DL.Rmd"><code>vignettes/Tutorials/Applying_DL.Rmd</code></a></small>
      <div class="hidden name"><code>Applying_DL.Rmd</code></div>

    </div>

    
    
<p>One, if not the central, problem in fitting drift-diffusion models is given by their random nature, namely their diffusion. Thus, no functional relation between the domain (i.e. the model parameters) and the codomain (i.e. the data/representation) can be established. However, this does not inherently predict that there is no pattern in the connection between the two. One way to address such problems is through deep learning. However, such an endeavour would require a lot of data. Fortunately, DDModeling has got you covered!</p>
<p>You can easily convert GRIDs into learning data (see <a href="Generate_GRIDs.html">here</a> for a tutorial on GRID generation).</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Pelzer402/DDModeling">DDModeling</a></span><span class="op">)</span>
<span class="va">DSTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/DDModel.html">DDModel</a></span><span class="op">(</span>model<span class="op">=</span><span class="st">"DSTP"</span>,task <span class="op">=</span> <span class="st">"flanker"</span>, CDF_perc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span><span class="op">)</span>, CAF_perc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>
<span class="va">Grid_DSTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/Generate_GRID.html">Generate_GRID</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">DSTP</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"DSTP_Flanker"</span>, eval_pts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">DSTP</span><span class="op">@</span><span class="va">DM</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/Import_GRID.html">Import_GRID</a></span><span class="op">(</span>grid_path <span class="op">=</span> <span class="va">Grid_DSTP</span>,to <span class="op">=</span> <span class="st">"keras_data"</span><span class="op">)</span></pre></div>
<p>The function <code><a href="../../reference/Import_GRID.html">Import_GRID()</a></code> needs two arguments <strong>grid path</strong> and <strong>to</strong>. The first takes the path to the directory where the GRID is stored, the second specifies the format in which the import should be done. <code>to = "data_keras"</code> returns a list containing an INPUT and an OUTPUT which can be used for deep learning.</p>
<p>DDModeling uses Tensorflow and Keras for deep learning, so make sure you install them before!</p>
<p>With the data setup correctly you can quickly create a model!</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># General note: You should always scale INPUT and OUTPUT!</span>
<span class="va">DATA</span><span class="op">$</span><span class="va">INPUT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">DATA</span><span class="op">$</span><span class="va">INPUT</span><span class="op">)</span>
<span class="va">DATA</span><span class="op">$</span><span class="va">OUTPUT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">DATA</span><span class="op">$</span><span class="va">OUPUT</span><span class="op">)</span>
<span class="co"># DDModeling gives you a handy function to extracted the scaling information!</span>
<span class="va">DATA_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/Scale_DL_Data.html">Scale_DL_Data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DATA</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://keras.rstudio.com">keras</a></span><span class="op">)</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>input_shape<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">DATA</span><span class="op">$</span><span class="va">INPUT</span><span class="op">)</span>,units <span class="op">=</span> <span class="fl">10</span>, activation <span class="op">=</span> <span class="st">"relu"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_batch_normalization.html">layer_batch_normalization</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dropout.html">layer_dropout</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">20</span>, activation <span class="op">=</span> <span class="st">"relu"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_batch_normalization.html">layer_batch_normalization</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dropout.html">layer_dropout</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">DATA</span><span class="op">$</span><span class="va">OUTPUT</span><span class="op">)</span>,activation <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span>

<span class="va">model</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>
  loss <span class="op">=</span> <span class="st">"mean_squared_error"</span>,
  optimizer <span class="op">=</span> <span class="st">"adam"</span>,
  metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"mae"</span>,<span class="st">"mape"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">model</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/fit.html">fit</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">DATA</span><span class="op">$</span><span class="va">INPUT</span>, y <span class="op">=</span> <span class="va">DATA</span><span class="op">$</span><span class="va">OUTPUT</span>,
    epochs <span class="op">=</span> <span class="fl">50</span>,
    batch_size <span class="op">=</span> <span class="fl">16</span>,
    verbose <span class="op">=</span> <span class="fl">1</span>,
    validation_split <span class="op">=</span> <span class="fl">0.1</span>,
    shuffle <span class="op">=</span> <span class="cn">TRUE</span>,
    callbacks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/keras/man/callback_reduce_lr_on_plateau.html">callback_reduce_lr_on_plateau</a></span><span class="op">(</span>factor <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></pre></div>
<p>You can either use this in your own code in any way you like or further integrate it with DDModeling!</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/Pelzer402">Thomas Pelzer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
